{% extends "base.html" %}
{% block title %}마이페이지{% endblock %}

{% block content %}
<main class="my-page">

    <!-- 좌측 메뉴 -->
    <nav class="side-menu">
        <ul>
            <li><a href="javascript:void(0)" class="menu-item active" data-tab="profile">개인정보 수정</a></li>
            <li><a href="javascript:void(0)" class="menu-item" data-tab="orders">주문내역</a></li>
            <li><a href="javascript:void(0)" class="menu-item" data-tab="cart">장바구니</a></li>
            <li><a href="javascript:void(0)" class="menu-item" data-tab="change_password">비밀번호 변경</a></li>
            {% if session.get('user_aff', '') == '유가' %}
                <li><a href="javascript:void(0)" class="menu-item" data-tab="admin">관리자 기능</a></li>
            {% endif %}
        </ul>
    </nav>

    <!-- 우측 내용 영역 -->
    <div class="tab-contents">

        <!-- 개인정보 수정 -->
        <div id="profile" class="tab-content">
            <h3>개인정보 수정</h3>
            <form action="{{ url_for('edit_profile') }}" method="POST">
                <label>이름:</label>
                <input type="text" name="name" value="{{ user.name }}"><br>
                <label>직함:</label>
                <input type="text" name="title" value="{{ user.title }}"><br>
                <label>소속:</label>
                <input type="text" name="affiliation" value="{{ user.affiliation }}"><br>
                <label>기본주소:</label>
                <input type="text" name="base_address" value="{{ user.base_address }}"><br>
                <label>상세주소:</label>
                <input type="text" name="detail_address" value="{{ user.detail_address }}"><br>
                <label>전화번호:</label>
                <input type="text" name="phone" value="{{ user.phone }}"><br>
                <button type="submit" class="btn-save">수정</button>
            </form>
        </div>

        <!-- 주문내역 -->
        <div id="orders" class="tab-content">
            <h3>주문내역</h3>
            <ul class="order-list" id="order-list">
                <!-- ✅ 주문내역은 my_page.js에서 Ajax로 로드됨 -->
            </ul>
            <div id="pagination" class="pagination">
                <!-- ✅ 페이지네이션 버튼도 JS에서만 생성 -->
            </div>
        </div>



        <!-- 장바구니 -->
        <div id="cart" class="tab-content">
            <h3>장바구니</h3>
            <ul id="cart-items-list-page"></ul>
            <div class="cart-total">총합: <span id="cart-total-page">0</span>원</div>
            <button type="button" id="checkout-btn-page" class="btn-checkout">구매하기</button>
        </div>

        <!-- 비밀번호 변경 -->
        <div id="change_password" class="tab-content">
            <h3>비밀번호 변경</h3>
            <form id="change-password-form">
                <label>새 비밀번호:</label>
                <input type="password" name="new_password" required><br>
                <label>비밀번호 확인:</label>
                <input type="password" name="confirm_password" required><br>
                <button type="submit" class="btn-save">변경</button>
            </form>
        </div>

        {% if session.get('user_aff', '') == '유가' %}
        <div id="admin" class="tab-content">
            <h3>관리자 기능</h3>

            <!-- 배너 이미지 추가 -->
            <form id="banner-upload-form" method="POST" enctype="multipart/form-data">
                <h4>배너 이미지 추가</h4>
                <label>이미지 이름:</label>
                <input type="text" name="image_name" placeholder="배너 이름" required><br>
                <label>이미지 선택:</label>
                <input type="file" name="banner_image" accept="image/*" required><br>
                <button type="submit">업로드</button>
            </form>
            <div id="banner-upload-msg"></div>
            <hr>

            <!-- 프로모션 영상 추가 -->
            <form id="video-upload-form" method="POST" enctype="multipart/form-data">
                <h4>프로모션 영상 추가</h4>
                <label>영상 설명:</label>
                <input type="text" name="description" placeholder="영상 설명" required><br>
                <label>영상 파일:</label>
                <input type="file" name="video_file" accept="video/*"><br>
                <label>유튜브 URL (선택):</label>
                <input type="url" name="video_url" placeholder="https://www.youtube.com/watch?v=..."><br>
                <label>영상 이름:</label>
                <input type="text" name="video_name" placeholder="영상 이름 (선택)"><br>
                <button type="submit">업로드</button>
            </form>
            <div id="video-upload-msg"></div>
        </div>
        {% endif %}

    </div>
</main>

{% endblock %}
